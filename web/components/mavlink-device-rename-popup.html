<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rename MAVLink Device</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <style>
        * { font-family: 'Inter', sans-serif; }
        ::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>

<!-- Popup Container -->
<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white w-[100vw] h-[100vh] shadow-lg overflow-y-auto">

        <!-- Header -->
        <div class="border-b border-neutral-200 p-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                        <i class="fa-solid fa-pen-to-square text-blue-600 text-lg"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl text-neutral-900">Rename MAVLink Device</h1>
                        <p class="text-neutral-500 text-sm">Update the display name for this flight controller</p>
                    </div>
                </div>
                <button id="popup-close" class="w-8 h-8 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center">
                    <i class="fa-solid fa-xmark text-neutral-500"></i>
                </button>
            </div>
        </div>

        <!-- Content -->
        <div class="p-6">
            <div class="max-w-2xl mx-auto">

                <!-- Current Device Info -->
                <div class="bg-neutral-50 border border-neutral-200 rounded-lg p-4 mb-6">
                    <h3 class="text-sm font-medium text-neutral-900 mb-2">Current Device Information</h3>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div>
                            <span class="text-neutral-600">Device Type:</span>
                            <span class="ml-2 text-neutral-900">Primary Flight Controller</span>
                        </div>
                        <div>
                            <span class="text-neutral-600">Hardware:</span>
                            <span class="ml-2 text-neutral-900">Pixhawk 6C</span>
                        </div>
                        <div>
                            <span class="text-neutral-600">System ID:</span>
                            <span class="ml-2 text-neutral-900">1</span>
                        </div>
                        <div>
                            <span class="text-neutral-600">Status:</span>
                            <span class="ml-2 text-green-600">Active</span>
                        </div>
                    </div>
                </div>

                <!-- Rename Form -->
                <div class="space-y-6">
                    <div>
                        <label for="device-name" class="block text-sm font-medium text-neutral-700 mb-2">
                            Device Display Name
                        </label>
                        <input 
                            type="text" 
                            id="device-name"
                            value="Primary Flight Controller" 
                            class="w-full px-4 py-3 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg"
                            placeholder="Enter new device name"
                            maxlength="50"
                        >
                        <p class="text-xs text-neutral-500 mt-1">Choose a descriptive name to easily identify this device</p>
                    </div>

                    <div>
                        <label for="device-description" class="block text-sm font-medium text-neutral-700 mb-2">
                            Description (Optional)
                        </label>
                        <textarea 
                            id="device-description"
                            rows="3"
                            class="w-full px-4 py-3 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            placeholder="Add a description for this device..."
                            maxlength="200"
                        ></textarea>
                        <p class="text-xs text-neutral-500 mt-1">Optional description to provide more context about this device</p>
                    </div>
                </div>

                <!-- Name Suggestions -->
                <div class="mt-6">
                    <h4 class="text-sm font-medium text-neutral-700 mb-3">Quick Name Suggestions</h4>
                    <div class="flex flex-wrap gap-2">
                        <button class="px-3 py-1 text-sm bg-neutral-100 text-neutral-700 rounded-full hover:bg-neutral-200 transition-colors" onclick="setDeviceName('Primary Flight Controller')">
                            Primary FC
                        </button>
                        <button class="px-3 py-1 text-sm bg-neutral-100 text-neutral-700 rounded-full hover:bg-neutral-200 transition-colors" onclick="setDeviceName('Main Flight Controller')">
                            Main FC
                        </button>
                        <button class="px-3 py-1 text-sm bg-neutral-100 text-neutral-700 rounded-full hover:bg-neutral-200 transition-colors" onclick="setDeviceName('Pixhawk Primary')">
                            Pixhawk Primary
                        </button>
                        <button class="px-3 py-1 text-sm bg-neutral-100 text-neutral-700 rounded-full hover:bg-neutral-200 transition-colors" onclick="setDeviceName('Flight Controller 1')">
                            Flight Controller 1
                        </button>
                    </div>
                </div>

                <!-- Warning Notice -->
                <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mt-6">
                    <div class="flex items-center">
                        <i class="fa-solid fa-info-circle text-blue-400 mr-3"></i>
                        <div>
                            <p class="text-sm text-blue-800 font-medium">Note</p>
                            <p class="text-sm text-blue-700 mt-1">
                                Renaming this device only changes the display name in the interface. The actual device configuration and system ID remain unchanged.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="border-t border-neutral-200 px-6 py-4 bg-neutral-50">
            <div class="flex items-center justify-between max-w-2xl mx-auto">
                <button class="text-neutral-600 hover:text-neutral-800 text-sm">
                    Reset to Default
                </button>
                <div class="flex items-center space-x-3">
                    <button id="popup-cancel" class="border border-neutral-300 text-neutral-700 px-6 py-2 rounded-lg hover:bg-neutral-50 transition-colors">
                        Cancel
                    </button>
                    <button id="save-changes" class="bg-blue-600 text-white px-8 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                        <i class="fa-solid fa-save mr-2"></i>
                        Save Changes
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        registerRenamePopupHandlers();
    });

    function registerRenamePopupHandlers() {
        const closeBtn = document.getElementById('popup-close');
        const cancelBtn = document.getElementById('popup-cancel');
        const saveBtn = document.getElementById('save-changes');

        if (closeBtn) {
            closeBtn.addEventListener('click', hideRenamePopup);
        }

        if (cancelBtn) {
            cancelBtn.addEventListener('click', hideRenamePopup);
        }

        if (saveBtn) {
            saveBtn.addEventListener('click', saveDeviceRename);
        }
    }

    function hideRenamePopup() {
        // Send message to parent window to close popup
        window.parent.postMessage({type: 'close-rename-popup'}, '*');
    }

    function saveDeviceRename() {
        const deviceName = document.getElementById('device-name').value.trim();
        const deviceDescription = document.getElementById('device-description').value.trim();

        if (!deviceName) {
            alert('Please enter a device name');
            return;
        }

        // Send rename data to parent window
        window.parent.postMessage({
            type: 'device-rename-confirmed',
            data: {
                name: deviceName,
                description: deviceDescription
            }
        }, '*');
    }

    function setDeviceName(name) {
        document.getElementById('device-name').value = name;
        document.getElementById('device-name').focus();
    }

    // Listen for messages from parent window
    window.addEventListener('message', function(event) {
        if (event.data.type === 'close-rename-popup') {
            // Popup is being closed, perform cleanup if needed
        }
    });
</script>

</body>
</html>